<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="ChenJunYu">





<title>Redis | JunYu&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.3.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">JunYu&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">JunYu&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Redis</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">ChenJunYu</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">February 24, 2021&nbsp;&nbsp;18:06:00</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Redis/">Redis</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="ä»€ä¹ˆæ˜¯Redisï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Redisï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Redisï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Redisï¼Ÿ</h1><p>ç®€å•æ¥è¯´Rediså…¶å®å°±æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œåªä¸è¿‡æ˜¯<strong>å†…å­˜</strong>æ•°æ®åº“ï¼Œæä¾›äº†<strong>æŒä¹…åŒ–</strong>çš„åŠŸèƒ½ã€‚Redisæ˜¯ä½¿ç”¨Cè¯­è¨€å¼€å‘çš„ã€æ”¯æŒç½‘ç»œäº¤äº’çš„<strong>Key-Value</strong>æ•°æ®åº“ã€‚Redisçš„<strong>è¯»å†™é€Ÿåº¦éå¸¸å¿«</strong>ï¼Œå¯ä»¥æ”¯æŒæ¯ç§’åå‡ ä¸‡æ¬¡çš„è¯»/å†™æ“ä½œï¼Œå› æ­¤è¢«å¹¿æ³›åº”ç”¨äº<strong>ç¼“å­˜</strong>ã€‚<br><strong>æ³¨ï¼šRedisæ˜¯ä¸€ç§NoSql(éå…³ç³»å‹æ•°æ®åº“)</strong></p>
<h1 id="Redisæ•°æ®ç»“æ„"><a href="#Redisæ•°æ®ç»“æ„" class="headerlink" title="Redisæ•°æ®ç»“æ„"></a>Redisæ•°æ®ç»“æ„</h1><blockquote>
<p>1.å­—ç¬¦ä¸²ï¼ˆstringï¼‰<br>2.åˆ—è¡¨ï¼ˆlistï¼‰<br>3.é›†åˆï¼ˆsetï¼‰<br>4.æœ‰åºé›†åˆï¼ˆsorted setï¼‰<br>5.å“ˆå¸Œï¼ˆhashï¼‰</p>
</blockquote>
<h2 id="å­—ç¬¦ä¸²String"><a href="#å­—ç¬¦ä¸²String" class="headerlink" title="å­—ç¬¦ä¸²String"></a>å­—ç¬¦ä¸²String</h2><p>stringç±»å‹æ˜¯ä¸€ä¸ªå¾ˆåŸºç¡€çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿæ˜¯ä»»ä½•å­˜å‚¨ç³»ç»Ÿéƒ½å¿…å¤‡çš„æ•°æ®ç±»å‹ã€‚<br>å¸¸ç”¨å‘½ä»¤ï¼š<code>set,get,strlen,exists,incr</code>ç­‰ã€‚<br>æ™®é€šå­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set name &quot;cjy&quot;   &#x2F;&#x2F;è®¾ç½®keyä¸ºname valueä¸º&quot;cjy&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name   &#x2F;&#x2F;å¾—åˆ°keyä¸ºnameçš„å€¼</span><br><span class="line">&quot;cjy&quot;</span><br><span class="line">127.0.0.1:6379&gt; strlen name   &#x2F;&#x2F;å€¼çš„é•¿åº¦</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; exists name   &#x2F;&#x2F;æ˜¯å¦å­˜åœ¨</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; set num &quot;1&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr num   &#x2F;&#x2F;å­—ç¬¦ä¸²å€¼ä¸ºæ•´æ•°çš„è¯åˆ™å¯ä»¥è‡ªå¢</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line">&quot;2&quot;</span><br><span class="line">127.0.0.1:6379&gt; decr num   &#x2F;&#x2F; è‡ªå‡</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line">&quot;1&quot;</span><br><span class="line">127.0.0.1:6379&gt;mset name1 &quot;cjy1&quot; name2 &quot;cjy2&quot; &#x2F;&#x2F;æ‰¹é‡è®¾ç½®</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; mget name1 name2  &#x2F;&#x2F;æ‰¹é‡è·å–</span><br><span class="line">1) &quot;cjy1&quot;</span><br><span class="line">2) &quot;cjy2&quot;</span><br></pre></td></tr></table></figure>
<h2 id="åˆ—è¡¨List"><a href="#åˆ—è¡¨List" class="headerlink" title="åˆ—è¡¨List"></a>åˆ—è¡¨List</h2><p>åœ¨Redisä¸­ï¼Œlistçš„å®ç°å¹¶ä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯<strong>åŒå‘é“¾è¡¨</strong>ï¼Œæ˜“äºæ’å…¥å’Œåˆ é™¤ï¼Œä½†æ˜¯é“¾è¡¨çš„éšæœºè®¿é—®å›°éš¾ã€‚<br>å¸¸ç”¨å‘½ä»¤ï¼š<code>lpush,lpop,rpush,rpop,lrange</code>ç­‰ã€‚<br>Listçš„ç®€å•ä½¿ç”¨ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lpush myList &quot;first&quot;   &#x2F;&#x2F;åœ¨myListå·¦ä¾§æ’å…¥å…ƒç´ &quot;first&quot;,å¦‚æœæ²¡æœ‰åˆ™åˆ›å»º</span><br><span class="line">(integer) 1                     &#x2F;&#x2F;è¿”å›å½“å‰listçš„å…ƒç´ ä¸ªæ•°</span><br><span class="line">127.0.0.1:6379&gt; rpush myList &quot;second&quot;   &#x2F;&#x2F;åœ¨myListå³ä¾§æ’å…¥å…ƒç´ &quot;second&quot;</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; lpush myList &quot;Zero&quot;    &#x2F;&#x2F;åœ¨myListå·¦ä¾§æ’å…¥å…ƒç´ </span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; lpop myList         &#x2F;&#x2F; å–å‡ºmyListæœ€å·¦è¾¹çš„å…ƒç´ </span><br><span class="line">&quot;Zero&quot;                       &#x2F;&#x2F; å–å‡ºçš„å…ƒç´ </span><br><span class="line">127.0.0.1:6379&gt; rpush myList third fourth  </span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; lrange myList 0 2     &#x2F;&#x2F;æŸ¥çœ‹myListä¸­ä¸‹æ ‡0åˆ°ä¸‹æ ‡2çš„å…ƒç´ </span><br><span class="line">1) &quot;first&quot;</span><br><span class="line">2) &quot;second&quot;</span><br><span class="line">3) &quot;third&quot;</span><br><span class="line">127.0.0.1:6379&gt; lrange myList 0 -1    &#x2F;&#x2F; æŸ¥çœ‹myListæ‰€æœ‰çš„å…ƒç´ </span><br><span class="line">1) &quot;first&quot;</span><br><span class="line">2) &quot;second&quot;</span><br><span class="line">3) &quot;third&quot;</span><br><span class="line">4) &quot;fourth&quot;</span><br><span class="line">127.0.0.1:6379&gt; llen myList         &#x2F;&#x2F;æŸ¥çœ‹myListå…ƒç´ çš„ä¸ªæ•°</span><br><span class="line">(integer) 4</span><br></pre></td></tr></table></figure>
<h2 id="é›†åˆSet"><a href="#é›†åˆSet" class="headerlink" title="é›†åˆSet"></a>é›†åˆSet</h2><p>setç±»ä¼¼ä¸javaä¸­çš„<strong>HashSet</strong>ï¼Œæ˜¯ä¸€ç§<strong>æ— åºä¸”ä¸å…è®¸é‡å¤</strong>çš„é›†åˆï¼Œ setå¯ä»¥è½»æ˜“å®ç°äº¤é›†ã€å¹¶é›†ã€å·®é›†çš„æ“ä½œã€‚<br>å¸¸ç”¨å‘½ä»¤ï¼š<code>sadd,spop,smembers,sismember,scard,sinterstore,sunion</code>ç­‰ã€‚<br>setçš„ç®€å•ä½¿ç”¨ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd mySet first second third   &#x2F;&#x2F;å¾€mySetä¸­æ·»åŠ å…ƒç´ firstã€secondã€thirdï¼Œæ²¡æœ‰åˆ™åˆ›å»º</span><br><span class="line">(integer) 3  </span><br><span class="line">127.0.0.1:6379&gt; sadd mySet first           &#x2F;&#x2F;æ·»åŠ é‡å¤å…ƒç´ </span><br><span class="line">(integer) 0                        &#x2F;&#x2F;ä¸º0 åˆ™æ·»åŠ å¤±è´¥ï¼Œä¸å…è®¸</span><br><span class="line">127.0.0.1:6379&gt; smembers mySet       &#x2F;&#x2F; æŸ¥çœ‹mySetçš„æ‰€æœ‰å…ƒç´ </span><br><span class="line">1) &quot;third&quot;</span><br><span class="line">2) &quot;second&quot;</span><br><span class="line">3) &quot;first&quot;</span><br><span class="line">127.0.0.1:6379&gt; scard mySet          &#x2F;&#x2F; æŸ¥çœ‹mySetçš„é•¿åº¦</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; sismember mySet first    &#x2F;&#x2F; æŸ¥çœ‹firstæ˜¯å¦åœ¨mySetä¸­</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd mySet2 third fourth fifth  &#x2F;&#x2F;æ·»åŠ å…ƒç´ åˆ° mySet2</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; sinter mySet mySet2    &#x2F;&#x2F; å¾—åˆ°mySetå’ŒmySet2çš„äº¤é›†</span><br><span class="line">1) &quot;third&quot;</span><br><span class="line">127.0.0.1:6379&gt; sunion mySet mySet2    &#x2F;&#x2F;å¾—åˆ°mySetå’ŒmySetçš„å¹¶é›†</span><br><span class="line">1) &quot;second&quot;</span><br><span class="line">2) &quot;third&quot;</span><br><span class="line">3) &quot;fifth&quot;</span><br><span class="line">4) &quot;first&quot;</span><br><span class="line">5) &quot;fourth&quot;</span><br><span class="line">127.0.0.1:6379&gt;</span><br><span class="line">127.0.0.1:6379&gt; srem mySet first     &#x2F;&#x2F; ç§»é™¤mySetä¸­firstå…ƒç´ ï¼Œæ²¡æœ‰åˆ™å¿½ç•¥</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>
<h2 id="æœ‰åºé›†åˆzset"><a href="#æœ‰åºé›†åˆzset" class="headerlink" title="æœ‰åºé›†åˆzset"></a>æœ‰åºé›†åˆzset</h2><p>å’Œsetä¸åŒçš„æ˜¯ï¼Œzsetå¢åŠ äº†ä¸€ä¸ªæƒé‡(score)ï¼Œä½¿å¾—é›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰ score è¿›è¡Œæœ‰åºæ’åˆ—ã€‚<br>å¸¸ç”¨å‘½ä»¤ï¼š<code>zadd,zcard,zscore,zrange,zrevrange,zrem</code>ç­‰ã€‚<br>æœ‰åºé›†åˆçš„ç®€å•ä½¿ç”¨ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd myZset 3 first    &#x2F;&#x2F; æ·»åŠ æƒé‡ä¸º3çš„å…ƒç´ first</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd myZset 2 second 1 third    &#x2F;&#x2F;æ‰¹é‡æ·»åŠ å…ƒç´ </span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zcard myZset        &#x2F;&#x2F; æŸ¥çœ‹myZsetçš„é•¿åº¦</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; zrange myZset 0 1    &#x2F;&#x2F;ä¸setä¸€æ ·æŸ¥çœ‹ä¸‹æ ‡ä¸º0åˆ°1çš„å…ƒç´ </span><br><span class="line">1) &quot;third&quot;</span><br><span class="line">2) &quot;second&quot;</span><br><span class="line">127.0.0.1:6379&gt;  zrange myZset 0 -1 withscores   &#x2F;&#x2F;æŸ¥çœ‹æ‰€æœ‰å…ƒç´ å’Œå„è‡ªçš„æƒé‡</span><br><span class="line">1) &quot;third&quot;</span><br><span class="line">2) &quot;1&quot;</span><br><span class="line">3) &quot;second&quot;</span><br><span class="line">4) &quot;2&quot;</span><br><span class="line">5) &quot;first&quot;</span><br><span class="line">6) &quot;3&quot;</span><br><span class="line">127.0.0.1:6379&gt; zrem myZset first      &#x2F;&#x2F;ç§»é™¤å…ƒç´ ï¼Œæ²¡æœ‰åˆ™å¿½ç•¥</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>
<h2 id="å“ˆå¸ŒHash"><a href="#å“ˆå¸ŒHash" class="headerlink" title="å“ˆå¸ŒHash"></a>å“ˆå¸ŒHash</h2><p>hash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨<strong>å¯¹è±¡</strong>ã€‚æ¯”å¦‚ä¸€ä¸ªå­¦ç”Ÿçš„å§“åã€å¹´é¾„ç­‰ã€‚<br>å¸¸ç”¨å‘½ä»¤ï¼š<code>hset,hmset,hexists,hget,hgetall,hkeys,hvals</code>ç­‰ã€‚<br>å“ˆå¸Œçš„ç®€å•ä½¿ç”¨ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hmset student1 name &quot;cjy&quot; age 18   &#x2F;&#x2F;åˆ›å»ºhashå¹¶èµ‹å€¼</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; hexists student1 name    &#x2F;&#x2F;æ˜¯å¦å­˜åœ¨naneå­—æ®µ</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hget student1 name    &#x2F;&#x2F;è·å–nameå­—æ®µ</span><br><span class="line">&quot;cjy&quot;</span><br><span class="line">127.0.0.1:6379&gt; hgetall student1    &#x2F;&#x2F;æŸ¥çœ‹student1æ‰€æœ‰å­—æ®µå’Œå€¼</span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;cjy&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;18&quot;</span><br><span class="line">127.0.0.1:6379&gt; hkeys student1   &#x2F;&#x2F;æŸ¥çœ‹student1æ‰€æœ‰å­—æ®µ</span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;age&quot;</span><br><span class="line">127.0.0.1:6379&gt; hvals student1   &#x2F;&#x2F;æŸ¥çœ‹student1æ‰€æœ‰å€¼</span><br><span class="line">1) &quot;cjy&quot;</span><br><span class="line">2) &quot;18&quot;</span><br><span class="line">127.0.0.1:6379&gt; hset student1 age 20   &#x2F;&#x2F;ä¿®æ”¹student1å­—æ®µageçš„å€¼</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; hgetall student1</span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;cjy&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;20&quot;</span><br></pre></td></tr></table></figure>
<h1 id="Redisçš„æŒä¹…åŒ–"><a href="#Redisçš„æŒä¹…åŒ–" class="headerlink" title="Redisçš„æŒä¹…åŒ–"></a>Redisçš„æŒä¹…åŒ–</h1><p>å¦‚æœRedisä¸å¼€å¯æŒä¹…åŒ–çš„è¯ï¼Œredisåªæ˜¯ä¸ª<strong>å†…å­˜</strong>æ•°æ®åº“ï¼Œæ•°æ®éƒ½å­˜åœ¨å†…å­˜å½“ä¸­ï¼Œå¦‚æœæœåŠ¡å™¨é‡æ–°å¯åŠ¨ï¼Œæ•°æ®éƒ½ä¼š<strong>ä¸¢å¤±</strong>ã€‚<br>æˆ‘ä»¬éœ€è¦æŒä¹…åŒ–æ•°æ®ä¹Ÿå°±æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®å†™å…¥åˆ°ç¡¬ç›˜é‡Œé¢ï¼Œå¤§éƒ¨åˆ†åŸå› æ˜¯ä¸ºäº†ä¹‹å<strong>é‡ç”¨</strong>æ•°æ®ï¼ˆæ¯”å¦‚é‡å¯æœºå™¨ã€æœºå™¨æ•…éšœä¹‹åæ¢å¤æ•°æ®ï¼‰ï¼Œæˆ–è€…æ˜¯ä¸ºäº†é˜²æ­¢ç³»ç»Ÿæ•…éšœè€Œå°†æ•°æ®å¤‡ä»½åˆ°ä¸€ä¸ªè¿œç¨‹ä½ç½®ã€‚</p>
<h2 id="ä¸¤ç§æŒä¹…åŒ–æ–¹å¼"><a href="#ä¸¤ç§æŒä¹…åŒ–æ–¹å¼" class="headerlink" title="ä¸¤ç§æŒä¹…åŒ–æ–¹å¼"></a>ä¸¤ç§æŒä¹…åŒ–æ–¹å¼</h2><p>redisæä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯RDBï¼ˆRedis DataBaseï¼‰å’ŒAOFï¼ˆAppend Only Fileï¼‰ã€‚</p>
<blockquote>
<p>RDBï¼Œç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯åœ¨ä¸åŒçš„æ—¶é—´ç‚¹ï¼Œå°†rediså­˜å‚¨çš„æ•°æ®ç”Ÿæˆå¿«ç…§å¹¶å­˜å‚¨åˆ°ç£ç›˜ç­‰ä»‹è´¨ä¸Šï¼›<br>AOFï¼Œåˆ™æ˜¯æ¢äº†ä¸€ä¸ªè§’åº¦æ¥å®ç°æŒä¹…åŒ–ï¼Œé‚£å°±æ˜¯å°†redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼Œåœ¨ä¸‹æ¬¡redisé‡æ–°å¯åŠ¨æ—¶ï¼Œåªè¦æŠŠè¿™äº›å†™æŒ‡ä»¤ä»å‰åˆ°åå†é‡å¤æ‰§è¡Œä¸€éï¼Œå°±å¯ä»¥å®ç°æ•°æ®æ¢å¤äº†ã€‚</p>
</blockquote>
<p>å…¶å®RDBå’ŒAOFä¸¤ç§æ–¹å¼ä¹Ÿå¯ä»¥åŒæ—¶ä½¿ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœredisé‡å¯çš„è¯ï¼Œåˆ™ä¼šä¼˜å…ˆé‡‡ç”¨AOFæ–¹å¼æ¥è¿›è¡Œæ•°æ®æ¢å¤ï¼Œè¿™æ˜¯å› ä¸ºAOFæ–¹å¼çš„æ•°æ®æ¢å¤å®Œæ•´åº¦æ›´é«˜ã€‚<br>å¦‚æœæ²¡æœ‰æ•°æ®æŒä¹…åŒ–çš„éœ€æ±‚ï¼Œä¹Ÿå®Œå…¨å¯ä»¥å…³é—­RDBå’ŒAOFæ–¹å¼ï¼Œè¿™æ ·çš„è¯ï¼Œrediså°†å˜æˆä¸€ä¸ªçº¯å†…å­˜æ•°æ®åº“</p>
<h3 id="å¿«ç…§æŒä¹…åŒ–ï¼ˆRDBï¼‰"><a href="#å¿«ç…§æŒä¹…åŒ–ï¼ˆRDBï¼‰" class="headerlink" title="å¿«ç…§æŒä¹…åŒ–ï¼ˆRDBï¼‰"></a>å¿«ç…§æŒä¹…åŒ–ï¼ˆRDBï¼‰</h3><p>Redis å¯ä»¥é€šè¿‡åˆ›å»ºå¿«ç…§æ¥è·å¾—å­˜å‚¨åœ¨å†…å­˜é‡Œé¢çš„æ•°æ®åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„å‰¯æœ¬ã€‚Redis åˆ›å»ºå¿«ç…§ä¹‹åï¼Œå¯ä»¥å¯¹å¿«ç…§è¿›è¡Œå¤‡ä»½ï¼Œå¯ä»¥å°†å¿«ç…§å¤åˆ¶åˆ°å…¶ä»–æœåŠ¡å™¨ä»è€Œåˆ›å»ºå…·æœ‰ç›¸åŒæ•°æ®çš„æœåŠ¡å™¨å‰¯æœ¬ï¼ˆRedis ä¸»ä»ç»“æ„ï¼Œä¸»è¦ç”¨æ¥æé«˜ Redis æ€§èƒ½ï¼‰ï¼Œè¿˜å¯ä»¥å°†å¿«ç…§ç•™åœ¨åŸåœ°ä»¥ä¾¿é‡å¯æœåŠ¡å™¨çš„æ—¶å€™ä½¿ç”¨ã€‚<br>å¿«ç…§æŒä¹…åŒ–æ˜¯ Redis é»˜è®¤é‡‡ç”¨çš„æŒä¹…åŒ–æ–¹å¼ã€‚<br>å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚<br>è™½ç„¶RDBæœ‰ä¸å°‘ä¼˜ç‚¹ï¼Œä½†å®ƒçš„ç¼ºç‚¹ä¹Ÿæ˜¯ä¸å®¹å¿½è§†çš„ã€‚å¦‚æœä½ å¯¹æ•°æ®çš„å®Œæ•´æ€§éå¸¸æ•æ„Ÿï¼Œé‚£ä¹ˆRDBæ–¹å¼å°±ä¸å¤ªé€‚åˆä½ ï¼Œå› ä¸ºå³ä½¿ä½ æ¯5åˆ†é’Ÿéƒ½æŒä¹…åŒ–ä¸€æ¬¡ï¼Œå½“redisæ•…éšœæ—¶ï¼Œä»ç„¶ä¼šæœ‰è¿‘5åˆ†é’Ÿçš„æ•°æ®ä¸¢å¤±ã€‚</p>
<h3 id="åªè¿½åŠ æ–‡ä»¶æŒä¹…åŒ–ï¼ˆAOFï¼‰"><a href="#åªè¿½åŠ æ–‡ä»¶æŒä¹…åŒ–ï¼ˆAOFï¼‰" class="headerlink" title="åªè¿½åŠ æ–‡ä»¶æŒä¹…åŒ–ï¼ˆAOFï¼‰"></a>åªè¿½åŠ æ–‡ä»¶æŒä¹…åŒ–ï¼ˆAOFï¼‰</h3><p>AOFæ–¹å¼æ˜¯å°†æ‰§è¡Œè¿‡çš„å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼Œåœ¨æ•°æ®æ¢å¤æ—¶æŒ‰ç…§ä»å‰åˆ°åçš„é¡ºåºå†å°†æŒ‡ä»¤éƒ½æ‰§è¡Œä¸€éï¼Œå°±è¿™ä¹ˆç®€å•ã€‚<br>æˆ‘ä»¬é€šè¿‡é…ç½®æ–‡ä»¶<strong>redis.conf</strong>ä¸­çš„<strong>appendonly yes</strong>å°±å¯ä»¥æ‰“å¼€AOFåŠŸèƒ½ã€‚å¦‚æœæœ‰å†™æ“ä½œï¼ˆå¦‚SETç­‰ï¼‰ï¼Œrediså°±ä¼šå°†è¯¥å‘½ä»¤<strong>è¿½åŠ </strong>åˆ°AOFæ–‡ä»¶çš„æœ«å°¾ã€‚<br>é»˜è®¤çš„AOFæŒä¹…åŒ–ç­–ç•¥æ˜¯æ¯ç§’é’Ÿfsyncä¸€æ¬¡ï¼ˆfsyncæ˜¯æŒ‡æŠŠç¼“å­˜ä¸­çš„å†™æŒ‡ä»¤è®°å½•åˆ°ç£ç›˜ä¸­ï¼‰ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œredisä»ç„¶å¯ä»¥ä¿æŒå¾ˆå¥½çš„å¤„ç†æ€§èƒ½ï¼Œå³ä½¿redisæ•…éšœï¼Œä¹Ÿåªä¼šä¸¢å¤±æœ€è¿‘1ç§’é’Ÿçš„æ•°æ®ã€‚<br>å› ä¸ºé‡‡ç”¨äº†è¿½åŠ æ–¹å¼ï¼Œå¦‚æœä¸åšä»»ä½•å¤„ç†çš„è¯ï¼ŒAOFæ–‡ä»¶ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œä¸ºæ­¤ï¼Œredisæä¾›äº†AOFæ–‡ä»¶<strong>é‡å†™ï¼ˆrewriteï¼‰</strong>æœºåˆ¶ï¼Œå³å½“AOFæ–‡ä»¶çš„å¤§å°è¶…è¿‡æ‰€è®¾å®šçš„é˜ˆå€¼æ—¶ï¼Œrediså°±ä¼šå¯åŠ¨AOFæ–‡ä»¶çš„å†…å®¹å‹ç¼©ï¼Œåªä¿ç•™å¯ä»¥æ¢å¤æ•°æ®çš„æœ€å°æŒ‡ä»¤é›†ã€‚ä¸¾ä¸ªä¾‹å­æˆ–è®¸æ›´å½¢è±¡ï¼Œå‡å¦‚æˆ‘ä»¬è°ƒç”¨äº†100æ¬¡INCRæŒ‡ä»¤ï¼Œåœ¨AOFæ–‡ä»¶ä¸­å°±è¦å­˜å‚¨100æ¡æŒ‡ä»¤ï¼Œä½†è¿™æ˜æ˜¾æ˜¯å¾ˆä½æ•ˆçš„ï¼Œå®Œå…¨å¯ä»¥æŠŠè¿™100æ¡æŒ‡ä»¤åˆå¹¶æˆä¸€æ¡SETæŒ‡ä»¤ï¼Œè¿™å°±æ˜¯é‡å†™æœºåˆ¶çš„åŸç†ã€‚<br>AOFæ–¹å¼çš„å¦ä¸€ä¸ªå¥½å¤„ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªâ€œåœºæ™¯å†ç°â€æ¥è¯´æ˜ã€‚æŸåŒå­¦åœ¨æ“ä½œredisæ—¶ï¼Œä¸å°å¿ƒæ‰§è¡Œäº†FLUSHALLï¼Œå¯¼è‡´rediså†…å­˜ä¸­çš„æ•°æ®å…¨éƒ¨è¢«æ¸…ç©ºäº†ï¼Œè¿™æ˜¯å¾ˆæ‚²å‰§çš„äº‹æƒ…ã€‚ä¸è¿‡è¿™ä¹Ÿä¸æ˜¯ä¸–ç•Œæœ«æ—¥ï¼Œåªè¦redisé…ç½®äº†AOFæŒä¹…åŒ–æ–¹å¼ï¼Œä¸”AOFæ–‡ä»¶è¿˜æ²¡æœ‰è¢«é‡å†™ï¼ˆrewriteï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æœ€å¿«çš„é€Ÿåº¦æš‚åœrediså¹¶ç¼–è¾‘AOFæ–‡ä»¶ï¼Œå°†æœ€åä¸€è¡Œçš„FLUSHALLå‘½ä»¤åˆ é™¤ï¼Œç„¶åé‡å¯redisï¼Œå°±å¯ä»¥æ¢å¤redisçš„æ‰€æœ‰æ•°æ®åˆ°FLUSHALLä¹‹å‰çš„çŠ¶æ€äº†ã€‚æ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ï¼Œè¿™å°±æ˜¯AOFæŒä¹…åŒ–æ–¹å¼çš„å¥½å¤„ä¹‹ä¸€ã€‚ä½†æ˜¯å¦‚æœAOFæ–‡ä»¶å·²ç»è¢«é‡å†™äº†ï¼Œé‚£å°±æ— æ³•é€šè¿‡è¿™ç§æ–¹æ³•æ¥æ¢å¤æ•°æ®äº†ã€‚</p>
<h1 id="Redisäº‹åŠ¡å¤„ç†"><a href="#Redisäº‹åŠ¡å¤„ç†" class="headerlink" title="Redisäº‹åŠ¡å¤„ç†"></a>Redisäº‹åŠ¡å¤„ç†</h1><p>Redis å¯ä»¥é€šè¿‡ <code>MULTIï¼ŒEXECï¼ŒDISCARD å’Œ WATCH</code> ç­‰å‘½ä»¤æ¥å®ç°äº‹åŠ¡(transaction)åŠŸèƒ½ã€‚</p>
<blockquote>
<p>1.MULTIç”¨æ¥ç»„è£…ä¸€ä¸ªäº‹åŠ¡ï¼›<br>2.EXECç”¨æ¥æ‰§è¡Œä¸€ä¸ªäº‹åŠ¡ï¼›<br>3.DISCARDç”¨æ¥å–æ¶ˆä¸€ä¸ªäº‹åŠ¡ï¼›<br>4.WATCHç”¨æ¥ç›‘è§†ä¸€äº›keyï¼Œä¸€æ—¦è¿™äº›keyåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¢«æ”¹å˜ï¼Œåˆ™å–æ¶ˆäº‹åŠ¡çš„æ‰§è¡Œã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi   &#x2F;&#x2F;æ ‡è®°äº‹åŠ¡å¼€å§‹</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr num1  </span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incr num1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; exec    &#x2F;&#x2F;æ‰§è¡Œ</span><br><span class="line">1) (integer) 11</span><br><span class="line">2) (integer) 12</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ MULTIå‘½ä»¤åå¯ä»¥è¾“å…¥å¤šä¸ªå‘½ä»¤ã€‚Redisä¸ä¼šç«‹å³æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œè€Œæ˜¯å°†å®ƒä»¬æ”¾åˆ°é˜Ÿåˆ—ï¼Œå½“è°ƒç”¨äº†EXECå‘½ä»¤å°†æ‰§è¡Œæ‰€æœ‰å‘½ä»¤ã€‚</p>
<p>WATCHæœ¬èº«çš„ä½œç”¨æ˜¯â€œç›‘è§†keyæ˜¯å¦è¢«æ”¹åŠ¨è¿‡â€ï¼Œè€Œä¸”æ”¯æŒåŒæ—¶ç›‘è§†å¤šä¸ªkeyï¼Œåªè¦è¿˜æ²¡çœŸæ­£è§¦å‘äº‹åŠ¡ï¼ŒWATCHéƒ½ä¼šå°½èŒå°½è´£çš„ç›‘è§†ï¼Œä¸€æ—¦å‘ç°æŸä¸ªkeyè¢«ä¿®æ”¹äº†ï¼Œåœ¨æ‰§è¡ŒEXECæ—¶å°±ä¼šè¿”å›nilï¼Œè¡¨ç¤ºäº‹åŠ¡æ— æ³•è§¦å‘ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; watch num1  &#x2F;&#x2F;å¼€å§‹ç›‘è§†num1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set num1 20   &#x2F;&#x2F;åœ¨äº‹åŠ¡å¼€å¯ä¹‹å‰è¢«ä¿®æ”¹ä¸º20</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set num1 30   &#x2F;&#x2F;äº‹åŠ¡ä¸­ä¿®æ”¹num1çš„å€¼</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; exec</span><br><span class="line">(nil)            &#x2F;&#x2F;æ— æ³•æ‰§è¡Œ</span><br></pre></td></tr></table></figure>
        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>ChenJunYu</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://example.com/2021/02/24/Redis/">http://example.com/2021/02/24/Redis/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/02/25/Redis%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F/">Redisç¼“å­˜ç©¿é€</a>
            
            
            <a class="next" rel="next" href="/2021/02/23/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—                                                                                      </a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© ChenJunYu | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
